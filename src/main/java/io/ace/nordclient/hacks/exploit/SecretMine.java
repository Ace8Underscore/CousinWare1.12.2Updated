package io.ace.nordclient.hacks.exploit;

import io.ace.nordclient.CousinWare;
import io.ace.nordclient.event.EventPlayerDamageBlock;
import io.ace.nordclient.hacks.Hack;
import io.ace.nordclient.utilz.InventoryUtil;
import io.ace.nordclient.utilz.Setting;
import net.minecraft.init.Items;
import net.minecraft.item.ItemTool;
import net.minecraft.network.play.client.CPacketHeldItemChange;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.math.BlockPos;
import team.stiff.pomelo.impl.annotated.handler.annotation.Listener;

public class SecretMine extends Hack {

    Setting lessPacket;
    Setting lessPacket2;

    public SecretMine() {
        super("SecretMine", Category.EXPLOIT, 11993911);

        CousinWare.INSTANCE.settingsManager.rSetting(lessPacket = new Setting("StartPacket", this, true, "SecretMineLessPacket", true));
        CousinWare.INSTANCE.settingsManager.rSetting(lessPacket2 = new Setting("StopPacket", this, true, "SecretMineLessPacket2", true));

    }

    @Listener
    public void onUpdate(EventPlayerDamageBlock event) {
        if (!(mc.player.getHeldItemMainhand().getItem() instanceof ItemTool)) {
            if (InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE) != -1) {
                mc.player.connection.sendPacket(new CPacketHeldItemChange(InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE)));
                if (lessPacket.getValBoolean()) mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.START_DESTROY_BLOCK, event.getPos(), event.getDirection()));
                if (lessPacket2.getValBoolean()) mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.STOP_DESTROY_BLOCK, event.getPos(), event.getDirection()));
                mc.player.connection.sendPacket(new CPacketHeldItemChange(mc.player.inventory.currentItem));
            }
        }
    }

    public static void secretSwap(BlockPos pos) {
        if (!(mc.player.getHeldItemMainhand().getItem() instanceof ItemTool)) {
            if (InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE) != -1) {
                mc.player.connection.sendPacket(new CPacketHeldItemChange(InventoryUtil.findItemInHotbar(Items.DIAMOND_PICKAXE)));
                mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.START_DESTROY_BLOCK,pos, EnumFacing.SOUTH));
                mc.player.connection.sendPacket(new CPacketPlayerDigging(CPacketPlayerDigging.Action.STOP_DESTROY_BLOCK, pos, EnumFacing.SOUTH));
                mc.player.connection.sendPacket(new CPacketHeldItemChange(mc.player.inventory.currentItem));
            }
        }
    }
}
